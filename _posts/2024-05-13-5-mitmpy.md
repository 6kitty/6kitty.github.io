---
layout: post
title: "[5주차] mitm.py"
categories: [Web Hacking]
tags: [Python, pwntools, CTF]
last_modified_at: 2024-05-13
---

```python
#!/usr/bin/env python3

from pwn import *  # pip install pwntools
import json

HOST = "socket.cryptohack.org"
PORT = 11112

r = remote(HOST, PORT)

def json_recv():
    line = r.readline()
    return json.loads(line.decode())

def json_send(hsh):
    request = json.dumps(hsh).encode()
    r.sendline(request)

print(r.readline())
print(r.readline())
print(r.readline())
print(r.readline())

request = {
    "buy": "clothes"
}
json_send(request)

response = json_recv()

print(response)
```

일단 그대로 복붙 후 실행...

![Image](https://blog.kakaocdn.net/dna/LEOTd/btsHm1jwgXB/AAAAAAAAAAAAAAAAAAAAADR1Q9dXIo0nMZW-lTtW27W22h3z2yaWTyrRUPLDzIA6/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=9fYBwggTkixMjWE0LSdkvUDrH8o%3D)

이건 안된다, buy만 가능하다고 한다.  
buy와 flags 안된다.  
단수로 바꿔서 buy와 flag하면 나온다.

![Image](https://blog.kakaocdn.net/dna/zpHuO/btsHne3MgGY/AAAAAAAAAAAAAAAAAAAAACLI6tZ0VF9QHC7ABv0G6OjB7Xw9h_0xG6fSo2P4CfY9/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=nwu89kcTP8pOP7BsLkOn03fu5VI%3D)

![Image](https://blog.kakaocdn.net/dna/cVNKCp/btsHmDwfw0q/AAAAAAAAAAAAAAAAAAAAAFyuqc8juTdkm7d8tX16_ERc0sUGU0hHM6K-R9QrGHqX/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=0Fwkzh%2Bnp0oBl5Hdq%2BJpDPy%2F%2FxI%3D)