---
layout: post
title: "[5주차] Crackme#5"
categories: [SWING, Writeup, Self-study]
tags: [Crackme, Reverse Engineering, CTF]
last_modified_at: 2024-05-13
---

일단 crackme5.exe 모듈로 들어가고  

![Image 1](https://blog.kakaocdn.net/dna/PL0NK/btsHouR2tBW/AAAAAAAAAAAAAAAAAAAAAPhd7vM4TanIxnLTXbptb_Obp8Ltqk9jmY9uvEiau1mx/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=BTjHkUBlMw%2FJK4Zz0jR%2BHkw2mbk%3D)

문자열 참조를 해본다.  
well done! 참조하는 주소로 이동  

![Image 2](https://blog.kakaocdn.net/dna/9ox7z/btsHl7dgd8y/AAAAAAAAAAAAAAAAAAAAAAHFZQQ2IBl-UBhImvrtzwbNkfG6XEuXTMM58sKOGaeY/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=pSf9XIFawCLatXp7EFOk6sixGs8%3D)

well done으로 향하는 분기문이 수상하다  
그 위에 strcmp를 하는 crackme5.402324를 참조해보자  

![Image 3](https://blog.kakaocdn.net/dna/byZ84d/btsHnwJFqL5/AAAAAAAAAAAAAAAAAAAAAIffbU7rvouw0yn534UHUTiu-sNgEPzAA5Kf7DQKzWVY/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=KYyndAuDlSNPVteyw0QxYJzPuq8%3D)

메모리 맵에서 DATA쪽이 00402000~이므로 이동  

![Image 4](https://blog.kakaocdn.net/dna/ex9sSO/btsHl6FrpTI/AAAAAAAAAAAAAAAAAAAAABcVMgS6z3Ip7hK0n6O7tn_W0t-b9MmffjVI3zxZHwcH/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=SfmF5aLMGJKk2p6FSfneAlZMY1E%3D)

위를 더 자세히 봤더니 4023FD를 보면  

![Image 5](https://blog.kakaocdn.net/dna/ci8J6M/btsHmbtbKdz/AAAAAAAAAAAAAAAAAAAAAOEP1LFq74CUOn_-ddYbtuzg1tCxgHuu4JLWfRzqK91W/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=sr4pn6ThjSNowl6pYPIRhonAhwY%3D)

이렇게 시리얼 같은 게 숨겨져 있다.  
4562-ABEX와 L2C-5781... 뭔가 섞어서 입력해봤는데 다 틀렸댄다  

![Image 6](https://blog.kakaocdn.net/dna/bf2p5U/btsHl6k4Wd3/AAAAAAAAAAAAAAAAAAAAANjmU7m-_1EhT4rd4uqwo02Y8yQgke-YPhbEY91uDEaS/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=tDudUrBzj3XtHLxgxu56fhuMY9Y%3D)

동적 분석해보니까 숫자 부분이 1씩 add되더라  

![Image 7](https://blog.kakaocdn.net/dna/FnjZG/btsHm3afNLC/AAAAAAAAAAAAAAAAAAAAACbPpBseTwcSKa0LK80bhxfP3SLKayP6JhAD9ooiuNXa/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=JCrA%2FXHed6ujlo0a54bS2cPxFlg%3D)

분기문을 다 돌았더니 6784-ABEX가 되었다.  

![Image 8](https://blog.kakaocdn.net/dna/dAKmHS/btsHm0Lmw7E/AAAAAAAAAAAAAAAAAAAAADGnKOUoZTD8E6beGyFDgfdfrZTz0hTLekMih2VeE_jO/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=S3yOeDpPnIY5uMNdXfKTyTH6cEo%3D)

합한 시리얼 총 넘버는 L2C-57816784-ABEX  

![Image 9](https://blog.kakaocdn.net/dna/6w3e0/btsHmQPNNsq/AAAAAAAAAAAAAAAAAAAAAFqBPB6GREe9WKYzz2St0BgDu5GLiwL33KxvDxqx6nwe/img.png?credential=yqXZFxpELC7KVnFOS48ylbz2pIh7yKj8&expires=1769871599&allow_ip=&allow_referer=&signature=BdVivm%2FFfoaWLS0CoAirE5n5c7Q%3D)