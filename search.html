---
layout: page
title: Search
sidebar_link: true
sidebar_sort_order: 1
---

<div class="search-container">
  <div class="search-form">
    <input type="text" id="search-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”... (ì œëª©, ì¹´í…Œê³ ë¦¬, íƒœê·¸, ë³¸ë¬¸ ë‚´ìš© ê²€ìƒ‰ ê°€ëŠ¥)" autofocus>
    <button id="search-button">ê²€ìƒ‰</button>
  </div>
  <div id="search-status"></div>
  <ul id="results-container"></ul>
</div>

<script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>

<script>
  var searchData = [];
  var searchInput = document.getElementById('search-input');
  var resultsContainer = document.getElementById('results-container');
  var searchStatus = document.getElementById('search-status');
  var searchButton = document.getElementById('search-button');

  // HTML ì—”í‹°í‹° ë””ì½”ë”© í•¨ìˆ˜
  function decodeHTML(html) {
    var txt = document.createElement('textarea');
    txt.innerHTML = html;
    return txt.value;
  }

  // search.json ë¡œë“œ
  fetch('/search.json')
    .then(response => {
      if (!response.ok) {
        throw new Error('HTTP error ' + response.status);
      }
      return response.json();
    })
    .then(data => {
      console.log('ê²€ìƒ‰ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', data.length + 'ê°œ');
      searchData = data;
      searchStatus.textContent = data.length + 'ê°œì˜ í¬ìŠ¤íŠ¸ê°€ ê²€ìƒ‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
    })
    .catch(error => {
      console.error('ê²€ìƒ‰ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
      searchStatus.textContent = 'ê²€ìƒ‰ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.';
      searchStatus.classList.add('error');
    });

  // ê²€ìƒ‰ í•¨ìˆ˜
  function performSearch() {
    var query = searchInput.value.trim();

    console.log('ê²€ìƒ‰ì–´:', query);
    console.log('ê²€ìƒ‰ ë°ì´í„° ìˆ˜:', searchData.length);

    if (query === '') {
      resultsContainer.innerHTML = '';
      searchStatus.textContent = searchData.length + 'ê°œì˜ í¬ìŠ¤íŠ¸ê°€ ê²€ìƒ‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
      return;
    }

    var queryLower = query.toLowerCase();

    var results = searchData.filter(function(post) {
      // HTML ì—”í‹°í‹° ë””ì½”ë”©
      var title = decodeHTML(post.title || '').toLowerCase();
      var categories = decodeHTML(post.categories || '').toLowerCase();
      var tags = decodeHTML(post.tags || '').toLowerCase();
      var excerpt = decodeHTML(post.excerpt || '').toLowerCase();
      var content = decodeHTML(post.content || '').toLowerCase();

      var searchText = title + ' ' + categories + ' ' + tags + ' ' + excerpt + ' ' + content;

      var found = searchText.indexOf(queryLower) !== -1;

      if (found) {
        console.log('ë§¤ì¹­ëœ í¬ìŠ¤íŠ¸:', post.title);
      }

      return found;
    });

    console.log('ê²€ìƒ‰ ê²°ê³¼:', results.length + 'ê°œ');

    if (results.length === 0) {
      resultsContainer.innerHTML = '<div class="no-results">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ë³´ì„¸ìš”.</div>';
      searchStatus.textContent = 'ê²€ìƒ‰ ê²°ê³¼: 0ê°œ';
    } else {
      var html = results.slice(0, 20).map(function(post) {
        return `
          <li class="search-result-item">
            <a href="${post.url}" class="search-result-title">${decodeHTML(post.title)}</a>
            <div class="search-result-meta">
              ${post.categories ? '<span class="search-result-category">' + decodeHTML(post.categories) + '</span>' : ''}
              ${post.tags ? '<span class="search-result-tag">' + decodeHTML(post.tags) + '</span>' : ''}
              <span class="search-result-date">ğŸ“… ${post.date}</span>
            </div>
            <div class="search-result-excerpt">${decodeHTML(post.excerpt || '')}</div>
          </li>
        `;
      }).join('');

      resultsContainer.innerHTML = html;
      searchStatus.textContent = 'ê²€ìƒ‰ ê²°ê³¼: ' + results.length + 'ê°œ';
    }
  }

  // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­
  searchButton.addEventListener('click', performSearch);

  // ì—”í„° í‚¤ë¡œ ê²€ìƒ‰
  searchInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' || e.keyCode === 13) {
      e.preventDefault();
      performSearch();
    }
  });

  // ì‹¤ì‹œê°„ ê²€ìƒ‰ (ì„ íƒì‚¬í•­ - ì£¼ì„ ì²˜ë¦¬)
  // searchInput.addEventListener('input', performSearch);
</script>